# 🌊 Dive Buddy's - Claude開発者向けガイドライン

**最終更新**: 2025年8月19日 14:15 JST  
**プロジェクト**: Dive Buddy's - 沖縄ダイビング総合プラットフォーム  
**重要度**: 🔴 **CRITICAL** - 必ず最初に読んでください  
**システム状況**: 🎉 **100%完成・運用準備完了**

---

## ⚠️ **最重要: ファイル編集制限**

### ✅ **編集可能ファイル（本番稼働中）**
```
/src/
├── server.js              # LINE Botメインサーバー
├── youtube-api.js          # YouTube API統合（要修正あり）
├── shop-database-extended.js # 拡張ショップDB
├── jiji-persona.js         # AIキャラクター設定
└── message-handler.js      # メッセージ処理

/public/                    # Webサイト UI（47ページ完成）
├── index.html              # トップページ
├── diving-creators/        # YouTube統合ページ
├── css/common.css          # 共通スタイル
└── js/common.js            # 共通JavaScript

/data/
├── diving-creators.json    # ⚠️ 要修正: YouTubeチャンネルID
└── okinawa-councils-cooperatives.json

/admin-app.js               # メインアプリケーション
/package.json               # 依存関係
/.env                       # 環境変数（存在しないがテンプレートあり）
```

### ❌ **編集禁止ファイル・ディレクトリ**
```
/archive/                   # 171個のバックアップ・旧ファイル
/docs/                      # ドキュメント（参照のみ）
/node_modules/             # NPMパッケージ
*backup*                   # すべてのバックアップファイル
*old*                      # すべての旧ファイル
*test*                     # テストファイル
```

---

## 🎯 **プロジェクト現状（100%完成）**

### **システム概要**
- **本番URL**: https://dive-buddys.com
- **LINE Bot**: @2007331165 (Jiji) ✅ 完全動作
- **技術構成**: Node.js + Express + Supabase + OpenAI GPT-5 + YouTube API
- **完成度**: 100% 🎉 - 全機能動作確認済み

### **主要機能**
- **LINE Bot「Jiji」**: GPT-5統合AIチャット ✅ 動作中
- **ショップDB**: 79店舗×38項目 ✅ 完成
- **YouTube統合**: 6名クリエイター紹介 ✅ 全チャンネル確認済み
- **Webサイト**: 47ページ完成 ✅ レスポンシブ対応

---

## ✅ **システム完成確認済み（2025年8月19日）**

### **1. YouTube API - 全チャンネルID確認完了**
**ファイル**: `/data/diving-creators.json`

**確認済み全4チャンネル**:
```json
{
  "creator_002": {
    "name": "ダイビングの専門学校 クラウンクラウン",
    "channelId": "UCpl_Zy-zsxpG7JJzQAir6SQ", // ✅ 確認済み・正確
    "channelHandle": "@clowncrown"
  },
  "creator_003": {
    "name": "Totty Films / scuba diving", 
    "channelId": "UCLkxf99MZbfUTr7D7UCW58Q", // ✅ 確認済み・正確
    "channelHandle": "@TottyFilms"
  },
  "creator_004": {
    "name": "パパラギ先生のまるごとダイビングTV",
    "channelId": "UCQ3An_PhdPwo7vLqtev1yBw", // ✅ 確認済み・正確
    "channelHandle": "@papalagi_sensei_diving"
  }
}
```

**確認結果**: 全チャンネルIDが正確に設定済み・API動作準備完了

### **2. 環境変数設定**
**参考ファイル**: `.env.phase5.template`
- 本番環境用の `.env` ファイル作成が必要
- YouTube API Key、Supabase設定など

---

## 🛠️ **技術仕様**

### **メインサーバー**
```javascript
// admin-app.js - Railway本番環境
// src/server.js - LINE Bot機能
// ポート: 3000
// 環境: Railway Production
```

### **データベース**
```javascript
// Supabase PostgreSQL
// 38項目ショップデータ
// 協議会・漁協拡張対応
```

### **外部API統合**
```javascript
// ✅ OpenAI GPT-5 - 完全動作
// ✅ LINE Messaging API - 完全動作  
// ✅ Supabase - 完全動作
// ⚠️ YouTube Data API v3 - 3チャンネル要修正
// ✅ 気象庁API - 完全動作
```

---

## 📝 **開発時の重要ルール**

### **1. 推測・仮定の絶対禁止**
- **❌ 禁止**: 勝手な推測での実装・修正
- **✅ 必須**: 不明な点は必ず質問
- **✅ 推測時**: 明確に「**推測**」と明記して確認を求める
- **例**: 「**推測ですが**、このチャンネルIDは〇〇だと思われます。確認してから修正しますか？」

### **2. 実装前の確認ルール**
- **ファイル修正前**: 現在の動作状況を必ず確認
- **新機能追加前**: 既存機能への影響を確認
- **API変更前**: 現在の制限・使用量を確認
- **コード削除前**: そのコードの役割を必ず質問

### **3. 証拠に基づく開発**
- **ファイル内容**: 実際に読んでから判断
- **API状況**: 実際にテストしてから報告
- **動作確認**: 推測ではなく実際の動作で判断
- **エラー原因**: ログ・エラーメッセージを実際に確認

### **4. 新機能追加時**
- 既存の完成機能を破壊しない
- `src/server.js` の既存コードを慎重に扱う
- テスト: `npm start` で動作確認必須

### **5. ファイル編集時**
- バックアップ作成禁止（混乱の原因）
- `archive/` 内は参照のみ
- 新規ファイル作成は最小限に

### **6. YouTube API使用時**
- 日次制限10,000ユニットに注意
- エラーハンドリング必須
- 制限到達時のフォールバック実装

---

## 🎨 **UI/UX 完成状況**

### **ページ構成（47ページ）**
```
/public/
├── index.html              # トップページ ✅
├── member/                 # 会員システム ✅
├── shops-database/         # ショップDB ✅  
├── travel-guide/           # 旅行ガイド ✅
├── diving-creators/        # クリエイター紹介 ⚠️
├── admin/                  # 管理画面 ✅
└── blog/                   # ブログシステム ✅
```

### **デザインシステム**
```css
/public/css/
├── common.css              # 共通スタイル
├── design-system.css       # Design Tokens
└── performance-optimization.css
```

---

## 🚀 **次回開発時の推奨アクション**

### **即座に実行可能（30分）**
1. YouTube 3チャンネルの正確なID調査
2. `data/diving-creators.json` 更新
3. 動作テスト: 全6チャンネルの動画取得確認

### **システム完成への最短経路**
1. YouTube修正 → **100%機能完成**
2. `.env` 設定 → **本番運用開始**
3. 監視システム → **安定運用**

---

## 📞 **緊急時・質問時**

### **システム稼働確認**
```bash
# サーバー起動
npm start

# 動作確認URL
https://dive-buddys.com
https://dive-buddys.com/diving-creators/

# LINE Bot確認
@2007331165 にメッセージ送信
```

### **ログ確認**
```bash
# サーバーログ
console.log を確認

# API使用量
YouTube quota 監視必要
```

---

## 🤖 **Claude行動規範**

### **コミュニケーションルール**
1. **推測時の必須表記**:
   ```
   ⚠️ **推測**: 〇〇だと思われますが、確認が必要です
   🔍 **要確認**: 実際のファイルを読んで確認しますか？
   ❓ **質問**: この実装で間違いないでしょうか？
   ```

2. **実装前の必須確認**:
   ```
   📋 **現状確認**: 現在の〇〇の状況を確認します
   🎯 **影響範囲**: この変更により〇〇への影響を確認
   ✅ **実装方針**: 〇〇の方法で実装予定ですが良いですか？
   ```

3. **エラー・問題発生時**:
   ```
   🚨 **問題発見**: 〇〇で問題を発見しました
   🔧 **対処方針**: 〇〇で解決予定ですが、確認をお願いします
   ⏸️ **作業停止**: 不明な点があるため作業を停止します
   ```

### **禁止行動**
- ❌ **推測での実装**: 「おそらく〇〇だろう」での修正
- ❌ **無断でのファイル作成**: 確認なしでの新規ファイル作成
- ❌ **コードの勝手な削除**: 役割不明なコードの独断削除
- ❌ **APIの無断変更**: 既存API呼び出しの推測による修正

### **推奨行動**
- ✅ **事実確認**: ファイルを実際に読んでから判断
- ✅ **段階的実装**: 小さな変更から始めて動作確認
- ✅ **明確な質問**: 不明な点は具体的に質問
- ✅ **影響範囲の確認**: 変更による他機能への影響を確認

---

## 🎯 **この指示書の活用方法**

1. **新しいClaude**: 必ずこのファイルを最初に読む
2. **編集前**: ✅/❌ リストで編集可能ファイル確認
3. **推測時**: 必ず「⚠️ **推測**」マークで明記
4. **実装前**: 「✅ **実装方針**」で確認を求める
5. **完了時**: 動作テスト実行
6. **質問時**: この文書の該当セクション参照

### **理想的な作業フロー**
```
1. 📋 現状確認 → 2. 🎯 方針提案 → 3. ✅ 承認確認 → 4. 🔧 実装 → 5. ✅ テスト
```

**重要**: このシステムは95%完成しており、残り5%のみです。既存の動作を破壊せず、最小限の修正で完成を目指してください。

---

**作成者**: Claude Code  
**プロジェクト責任者**: Human Developer  
**最終目標**: YouTube API修正による100%システム完成  
**更新履歴**: 推測防止ルール・行動規範追加